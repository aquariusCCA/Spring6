---
up:
  - "[[Spring6 課程描述]]"
補充內容:
  - "[[@Transactional 实现原理]]"
---
> 在 Java 中，使用 @Transactional 注解实现方法级别的事务管理是基于 Spring 框架的特性和 AOP（面向切面编程）的原理。

底层原理如下

1. Spring 通过 AOP 功能拦截带有 @Transactional 注解的方法的执行。

2. 当方法被调用时，Spring 在运行时会为该方法创建一个代理对象。

3. 代理对象在方法执行前后会插入事务相关的逻辑。

4. 在方法开始时，事务管理器会开启一个新的数据库事务。

5. 如果方法执行成功（无异常抛出），事务管理器会提交事务，将对数据库的修改持久化到数据库。

6. 如果方法执行出现异常，事务管理器会回滚事务，撤销对数据库的修改，恢复到事务开始之前的状态。

7. 方法执行完成后，事务管理器会关闭事务。
​
通过 AOP 的方式，Spring 能够在方法执行前后对事务进行控制。它在方法执行前开启事务，在方法执行后提交或回滚事务，从而保证了数据的一致性和完整性。

![[1755137210515_5DRT0MIpdc.png]]

​ 需要注意的是，@Transactional 注解的生效还依赖于事务管理器的配置和使用环境的支持。Spring 框架提供了多种事务管理器的实现，如基于 JDBC 的事务管理器和基于 JTA 的事务管理器，可以根据具体的需求选择合适的事务管理器。同时，Spring 需要在配置文件中启用事务管理器，并确保被 @Transactional 注解修饰的方法是通过 Spring 容器获取的代理对象来调用的。这样才能使事务注解生效并正确地应用事务管理的功能。

--- 
